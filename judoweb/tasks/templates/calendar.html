{% extends 'base.html' %}

{% block content %}    
<head>
    <meta charset="UTF-8">
    <title>Judo Yamato-Calendar</title>
</head> 
<script>
        document.addEventListener('DOMContentLoaded', function () {
        var textarea = document.getElementById('comment-text');
        var charCount = document.getElementById('char-count');
        var submitBtn = document.getElementById('submit-btn');
    
        textarea.addEventListener('input', function () {
            var remainingChars = 150 - textarea.value.length;
            charCount.textContent = remainingChars;
            if (remainingChars < 0) {
                submitBtn.disabled = true;
            } else {
                submitBtn.disabled = false;
            }
        });
    });
</script>
<main class="container py-5">
    <section class="card card-body d-flex justify-content-center align-items-center bg-secondary">
        <div>
            <h1 class="display-1 text-secondary text-center">CALENDAR</h1>
            <iframe 
                src="https://calendar.google.com/calendar/embed?height=600&wkst=2&ctz=Europe%2FMadrid&bgcolor=%23ffffff&hl=es&showPrint=0&showTitle=0&src=d2VlYnByb2plY3RqdWRvQGdtYWlsLmNvbQ&src=ZW4uc3BhaW4jaG9saWRheUBncm91cC52LmNhbGVuZGFyLmdvb2dsZS5jb20&color=%23039BE5&color=%230B8043" 
                style="border-width:0" 
                width="800" height="600" 
                frameborder="0" 
                scrolling="no">
            </iframe>

            <div class="contenido">
                <div>
                    {% for comment in comments %}
                        <p>{{ comment.user.username }}: {{ comment.text }}</p>
                        {% if comment.user == request.user or request.user.is_superuser %}
                            <form method="post" action="{% url 'delete_comment' comment.id %}">
                                {% csrf_token %}
                                <button type="submit">Eliminar</button>
                            </form>
                        {% endif %}
                    {% endfor %}
                </div>
                <form method="post" id="comment-form">
                    {% csrf_token %}
                    <textarea name="text" id="comment-text" rows="4" cols="50" maxlength="250"></textarea><br>
                    <span id="char-count">150</span> caracteres restantes<br>
                    <button type="submit" id="submit-btn">Enviar Comentario</button>
                </form>
                
            </div>

        </div>
    </section>
</main>
{% endblock %}
